# `ModuleEventRaiser.Generator` - An Event Raiser Generator for VB.NET Modules

## Description
`ModuleEventRaiser.Generator` is a .NET source generator that automatically creates event raiser methods for events declared in VB.NET modules. It helps developers to raise events in a consistent, efficient, and well-documented manner, reducing boilerplate code and improving code readability.

Currently available as a NuGet package: `dotnet add package ModuleEventRaiser.Generator --version 1.0.9`. _Note that versions 1.0.10 through 1.0.11 are identical to 1.0.9 in functionality except for documentation changes and/or internal code cleanup, so you do **not** need to upgrade if you are already using 1.0.9._

**Important Notes:**
- The source generator only works with VB.NET modules and does not support classes or structures.
- The generator includes `Imports System` by default in generated files.
- Additional imports for custom types any now properly recognized - no other settings required.
  - e.g. `Public Event CollidePoint(rect As RectangleF, point As Vector2)` (in VB.NET MonoGame projects)
  - This will include `Imports Microsoft.Xna.Framework` in the generated source file.

## Key Features
- **Automatic Code Generation**: Generates event raiser methods for all events in VB.NET modules
- **Well-Documented**: Includes XML documentation for all generated methods
- **Parameter Handling**: Correctly handles event parameters with proper types
- **Custom Event Types**: Supports both standard `EventHandler` and custom event types
- **Partial Modules**: Uses partial modules to seamlessly integrate with existing code
- **Incremental Generation**: Uses the latest incremental generator pattern for fast builds
- **Async Raiser Support**: Generates asynchronous raise methods for all partial module events

## Prerequisites
- [Visual Studio 2026](https://visualstudio.microsoft.com/vs/)
- [.NET SDK 8.0+](https://dotnet.microsoft.com/download)
- VB.NET project targeting .NET Standard 2.0 or later

## Installation
1. **Clone the repository** and navigate to the project directory:
    ```bash
    git clone https://github.com/Pac-Dessert1436/ModuleEventRaiser.Generator.git
    cd ModuleEventRaiser.Generator
    ```

2. **Build the source generator project**:
    ```bash
    dotnet build
    ```

3. **Reference the source generator** in your VB.NET project by adding the following to your `.vbproj` file:
    ```xml
    <ItemGroup>
        <ProjectReference Include="..\ModuleEventRaiser.Generator\ModuleEventRaiser.Generator.vbproj"
            OutputItemType="Analyzer" ReferenceOutputAssembly="false" />
    </ItemGroup>
    ```
4. You can also **install the source generator via NuGet** - no manual configuration required:
   ```bash
   dotnet add package ModuleEventRaiser.Generator --version 1.0.9
   ```
   - Versions 1.0.10 through 1.0.11 are **identical** to 1.0.9 in functionality except for documentation changes and/or internal code cleanup.

## Example Usage

### Input: VB.NET Module with Events
```vb
Partial Public Module MyEvents
    Public Event TemperatureChanged(temperature As Integer)
    Public Event HumidityChanged(humidity As Integer)
    Public Event LightLevelChanged(lightLevel As Integer)
End Module
```

### Output: Generated Event Raiser Methods
```vb
' <auto-generated>
'     This code was generated by `ModuleEventRaiser.Generator`.
'     Changes to this file may cause incorrect behavior and will be lost if
'     the code is regenerated.
' </auto-generated>

Option Explicit On
Option Strict On

Imports System
' Additional imports added through Settings module would appear here

Partial Public Module MyEvents

    ''' <summary>
    ''' Raises the TemperatureChanged event.
    ''' </summary>
    ''' <param name="temperature">The temperature parameter.</param>
    Public Sub RaiseEvent_TemperatureChanged(temperature As Integer)
        RaiseEvent TemperatureChanged(temperature)
    End Sub

    ''' <summary>
    ''' Raises the HumidityChanged event.
    ''' </summary>
    ''' <param name="humidity">The humidity parameter.</param>
    Public Sub RaiseEvent_HumidityChanged(humidity As Integer)
        RaiseEvent HumidityChanged(humidity)
    End Sub

    ''' <summary>
    ''' Raises the LightLevelChanged event.
    ''' </summary>
    ''' <param name="lightLevel">The lightLevel parameter.</param>
    Public Sub RaiseEvent_LightLevelChanged(lightLevel As Integer)
        RaiseEvent LightLevelChanged(lightLevel)
    End Sub

#Region "New in version 1.0.9+" 
    ''' <summary>
    ''' Asynchronously raises the TemperatureChanged event.
    ''' </summary>
    ''' <param name="temperature">The temperature parameter.</param>
    Public Async Function RaiseEventAsync_TemperatureChanged(temperature As Integer) As Task
        Await Task.Run(Sub() RaiseEvent TemperatureChanged(temperature))
    End Function

    ' NOTE: Asynchronous raise methods for other events would be similar to the above
#End Region

End Module
```

### How to Use the Generated Methods
```vb
' In another part of your code (e.g. a class that needs to raise events)
Private Sub UpdateEnvironmentalData()
    Dim newTemp As Integer = 25
    Dim newHumidity As Integer = 60
    Dim newLightLevel As Integer = 80
    
    ' Use the generated methods to raise events
    ' NOTE: Module names in VB.NET can be usually omitted
    RaiseEvent_TemperatureChanged(newTemp)
    RaiseEvent_HumidityChanged(newHumidity)
    RaiseEvent_LightLevelChanged(newLightLevel)
End Sub
```

## Technical Details

### How It Works
1. **Syntax Analysis**: The generator analyzes your VB.NET code to find events declared within modules
2. **Event Information Collection**: It collects details about each event, including its name, parameters, and containing module
3. **Code Generation**: For each event, it generates a properly documented `RaiseEvent_*` method
4. **Output**: The generated code is written to separate files named `{ModuleName}_EventRaisers.g.vb`

### Supported Event Patterns
The generator supports:
- Events with standard `EventHandler` type
- Events with custom delegate types
- Events with any number of parameters
- Events with different parameter types

### Generated Code Features
- **XML Documentation**: Each generated method includes summary and parameter documentation
- **Option Statements**: Includes `Option Explicit On` and `Option Strict On`
- **Auto-Generated Header**: Clearly marks generated code with a header
- **Imports Section**: Includes `Imports System` by default. Any custom types used in module events are now recognized by the source generator.
- **Well-Formatted Code**: Proper indentation and spacing for readability

## Benefits
- **Reduced Boilerplate Code**: No need to manually write event raiser methods
- **Consistent Pattern**: All event raisers follow the same pattern
- **Improved Readability**: Clear, well-documented raise methods
- **Fewer Errors**: Eliminates typos and parameter mismatches
- **Maintenance Friendly**: Automatically updates when events change

## License
This project is licensed under the BSD 3-Clause License. See the [LICENSE](LICENSE) file for details.
